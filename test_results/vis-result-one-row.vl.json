{
  "$schema": "https://vega.github.io/schema/vega-lite/v4.json",
  "data": {
    "url": "https://gist.githubusercontent.com/chanwutk/372377953c7413a85784d74057de674f/raw/3a1d7fbe870acc0df89c62ea9ed8758641c27e1a/reachable_airports_result_aggregated_2020_05_24.csv"
  },
  "transform": [
    {
      "calculate": "datum.labeler === 'particle' ? 'Particle-Based' : 'Bitmap-Based'",
      "as": "labeler"
    },
    {"calculate": "~~(datum.diff_runtime * 100)", "as": "diff_runtime_p"},
    {"calculate": "~~(datum.diff_placed * 100)", "as": "diff_placed_p"},
    {"filter": "datum.marksRenderer === 'vector'"},
    {"calculate": "~~datum.diff_runtime + '%'", "as": "text_diff_runtime"},
    {"calculate": "~~datum.diff_placed + '%'", "as": "text_diff_placed"}
  ],
  "hconcat": [
    {
      "title": "Runtime (ms)",
      "height": 170,
      "width": 200,
      "encoding": {
        "x": {
          "field": "chart_width",
          "type": "quantitative",
          "title": "Chart width and height"
        }
      },
      "layer": [
        {
          "transform": [{"filter": "datum.labeler === 'Particle-Based'"}],
          "mark": {"type": "area"},
          "encoding": {
            "y": {"field": "runtime", "type": "quantitative", "title": null},
            "y2": {"field": "pixel_runtime"},
            "color": {"value": "lightgray"}
          }
        },
        {
          "mark": {"type": "line", "point": true},
          "encoding": {
            "y": {"field": "runtime", "type": "quantitative"},
            "color": {
              "field": "labeler",
              "type": "nominal",
              "legend": {
                "orient": "bottom",
                "values": ["Particle-Based", "Bitmap-Based"]
              }
            }
          }
        },
        {
          "transform": [{"filter": "datum.labeler === 'Particle-Based'"}],
          "mark": {
            "type": "text",
            "point": true,
            "baseline": "bottom",
            "dy": -5
          },
          "encoding": {
            "y": {"field": "runtime", "type": "quantitative"},
            "color": {"field": "labeler", "type": "nominal"},
            "text": {
              "field": "runtime",
              "type": "quantitative",
              "format": ".0f"
            }
          }
        },
        {
          "transform": [{"filter": "datum.labeler === 'Bitmap-Based'"}],
          "mark": {"type": "text", "point": true, "baseline": "top", "dy": 5, "dx": 7},
          "encoding": {
            "y": {"field": "runtime", "type": "quantitative"},
            "color": {"field": "labeler", "type": "nominal"},
            "text": {
              "field": "runtime",
              "type": "quantitative",
              "format": ".0f"
            }
          }
        },
        {
          "transform": [{"filter": "datum.labeler === 'Particle-Based'"}],
          "mark": {"type": "text"},
          "encoding": {
            "y": {"field": "center_runtime", "type": "quantitative"},
            "text": {"field": "text_diff_runtime", "type": "nominal"},
            "color": {"value": "black"}
          }
        }
      ]
    },
    {
      "title": "Number of labels placed",
      "height": 170,
      "width": 200,
      "encoding": {
        "x": {
          "field": "chart_width",
          "type": "quantitative",
          "title": "Chart width and height"
        }
      },
      "layer": [
        {
          "transform": [{"filter": "datum.labeler === 'Particle-Based'"}],
          "mark": {"type": "area"},
          "encoding": {
            "y": {"field": "placed", "type": "quantitative", "title": null},
            "y2": {"field": "pixel_placed"},
            "color": {"value": "lightgray"}
          }
        },
        {
          "mark": {"type": "line", "point": true},
          "encoding": {
            "y": {"field": "placed", "type": "quantitative"},
            "color": {"field": "labeler", "type": "nominal"}
          }
        },
        {
          "transform": [{"filter": "datum.labeler === 'Particle-Based'"}],
          "mark": {
            "type": "text",
            "point": true,
            "baseline": "bottom",
            "dy": -5
          },
          "encoding": {
            "y": {"field": "placed", "type": "quantitative"},
            "color": {"field": "labeler", "type": "nominal"},
            "text": {"field": "placed", "type": "quantitative", "format": ".0f"}
          }
        },
        {
          "transform": [{"filter": "datum.labeler === 'Bitmap-Based'"}],
          "mark": {"type": "text", "point": true, "baseline": "top", "dy": 5, "dx": 11},
          "encoding": {
            "y": {"field": "placed", "type": "quantitative"},
            "color": {"field": "labeler", "type": "nominal"},
            "text": {"field": "placed", "type": "quantitative", "format": ".0f"}
          }
        },
        {
          "transform": [{"filter": "datum.labeler === 'Particle-Based'"}],
          "mark": {"type": "text"},
          "encoding": {
            "y": {"field": "center_placed", "type": "quantitative"},
            "text": {"field": "text_diff_placed", "type": "nominal"},
            "color": {"value": "black"}
          }
        }
      ]
    }
  ]
}